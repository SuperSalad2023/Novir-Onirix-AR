const panelContent=`
<svg width="110px" height="110px" viewBox="0 0 110 110" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>motion-icon</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Web-AR---Permissions-dialog--ios" transform="translate(-125.000000, -225.000000)" fill="#211F1F" fill-rule="nonzero">
            <path d="M180,225 C210.375661,225 235,249.624339 235,280 C235,310.375661 210.375661,335 180,335 C149.624339,335 125,310.375661 125,280 C125,249.624339 149.624339,225 180,225 Z M180,233.368368 C154.246061,233.368368 133.368368,254.246061 133.368368,280 C133.368368,305.753939 154.246061,326.631632 180,326.631632 C205.753939,326.631632 226.631632,305.753939 226.631632,280 C226.631632,254.246061 205.753939,233.368368 180,233.368368 Z M180,239 C185.21694,239 189.757901,243.131082 193.096205,249.865681 L193.437236,250.571588 C193.830049,251.405836 194.205079,252.277239 194.561402,253.183112 L194.862217,253.967954 C195.109043,254.628919 195.346189,255.307079 195.573318,256.001456 L195.841042,256.84243 C195.928666,257.125308 196.014666,257.410717 196.09902,257.698596 L196.347122,258.569579 C196.428162,258.862334 196.507535,259.157496 196.585219,259.455002 L196.81318,260.35449 C196.887464,260.656622 196.960037,260.961035 197.030877,261.267667 L197.23818,262.194158 C197.271857,262.349661 197.305096,262.505704 197.337893,262.662278 L197.806008,262.761985 L197.806008,262.761985 L198.732487,262.969277 C199.499058,263.146369 200.251762,263.33429 200.98962,263.5327 L201.867861,263.775806 L201.867861,263.775806 L202.731473,264.028853 L202.731473,264.028853 L203.580082,264.291712 C204.421063,264.559434 205.238975,264.841678 206.032126,265.137862 L206.816961,265.438671 C207.722827,265.794986 208.594223,266.17001 209.428464,266.562817 L210.134366,266.903842 C216.868918,270.242099 221,274.78306 221,280 C221,285.21694 216.868918,289.757901 210.134319,293.096205 L209.428412,293.437236 C208.594164,293.830049 207.722761,294.205079 206.816888,294.561402 L206.032046,294.862217 C205.371081,295.109043 204.692921,295.346189 203.998544,295.573318 L203.15757,295.841042 C202.874692,295.928666 202.589283,296.014666 202.301404,296.09902 L201.430421,296.347122 C201.137666,296.428162 200.842504,296.507535 200.544998,296.585219 L199.64551,296.81318 C199.343378,296.887464 199.038965,296.960037 198.732333,297.030877 L197.805842,297.23818 C197.650339,297.271857 197.494296,297.305096 197.337722,297.337893 L197.238015,297.806008 L197.238015,297.806008 L197.030723,298.732487 C196.853631,299.499058 196.66571,300.251762 196.4673,300.98962 L196.224194,301.867861 L196.224194,301.867861 L195.971147,302.731473 L195.971147,302.731473 L195.708288,303.580082 C195.440566,304.421063 195.158322,305.238975 194.862138,306.032126 L194.561329,306.816961 C194.205014,307.722827 193.82999,308.594223 193.437183,309.428464 L193.096158,310.134366 C189.757901,316.868918 185.21694,321 180,321 C174.78306,321 170.242099,316.868918 166.903795,310.134319 L166.562764,309.428412 C166.169951,308.594164 165.794921,307.722761 165.438598,306.816888 L165.137783,306.032046 C164.890957,305.371081 164.653811,304.692921 164.426682,303.998544 L164.158958,303.15757 C164.071334,302.874692 163.985334,302.589283 163.90098,302.301404 L163.652878,301.430421 C163.571838,301.137666 163.492465,300.842504 163.414781,300.544998 L163.18682,299.64551 C163.112536,299.343378 163.039963,299.038965 162.969123,298.732333 L162.76182,297.805842 C162.728143,297.650339 162.694904,297.494296 162.662107,297.337722 L162.193992,297.238015 L162.193992,297.238015 L161.267513,297.030723 C160.500942,296.853631 159.748238,296.66571 159.01038,296.4673 L158.132139,296.224194 L158.132139,296.224194 L157.268527,295.971147 L157.268527,295.971147 L156.419918,295.708288 C155.578937,295.440566 154.761025,295.158322 153.967874,294.862138 L153.183039,294.561329 C152.277173,294.205014 151.405777,293.82999 150.571536,293.437183 L149.865634,293.096158 C143.131082,289.757901 139,285.21694 139,280 C139,274.78306 143.131082,270.242099 149.865681,266.903795 L150.571588,266.562764 C151.405836,266.169951 152.277239,265.794921 153.183112,265.438598 L153.967954,265.137783 C154.628919,264.890957 155.307079,264.653811 156.001456,264.426682 L156.84243,264.158958 C157.125308,264.071334 157.410717,263.985334 157.698596,263.90098 L158.569579,263.652878 C158.862334,263.571838 159.157496,263.492465 159.455002,263.414781 L160.35449,263.18682 C160.656622,263.112536 160.961035,263.039963 161.267667,262.969123 L162.194158,262.76182 C162.349661,262.728143 162.505704,262.694904 162.662278,262.662107 L162.761985,262.193992 L162.761985,262.193992 L162.969277,261.267513 C163.146369,260.500942 163.33429,259.748238 163.5327,259.01038 L163.775806,258.132139 L163.775806,258.132139 L164.028853,257.268527 L164.028853,257.268527 L164.291712,256.419918 C164.559434,255.578937 164.841678,254.761025 165.137862,253.967874 L165.438671,253.183039 C165.794986,252.277173 166.17001,251.405777 166.562817,250.571536 L166.903842,249.865634 C170.242099,243.131082 174.78306,239 180,239 Z M192.498168,298.185229 L192.29717,298.213843 C188.409571,298.758044 184.277452,299.047244 180,299.047244 C175.648693,299.047244 171.447779,298.747971 167.501676,298.185427 L167.664909,298.852305 L167.833555,299.509901 C170.517571,309.738539 175.157712,316.480315 180,316.480315 C183.768482,316.480315 187.414529,312.397066 190.111335,305.764704 L190.412534,305.003063 C190.66008,304.359425 190.8989,303.693615 191.1283,303.006922 L191.399014,302.172948 L191.399014,302.172948 L191.660418,301.31942 C191.959855,300.312424 192.23974,299.266515 192.498168,298.185229 Z M180,265.472441 C175.239288,265.472441 170.703246,265.859406 166.548776,266.548776 C165.859406,270.703246 165.472441,275.239288 165.472441,280 C165.472441,284.760712 165.859406,289.296754 166.548776,293.451224 C170.703246,294.140594 175.239288,294.527559 180,294.527559 C184.760712,294.527559 189.296754,294.140594 193.451224,293.451224 C194.140594,289.296754 194.527559,284.760712 194.527559,280 C194.527559,275.239288 194.140594,270.703246 193.451224,266.548776 C189.296754,265.859406 184.760712,265.472441 180,265.472441 Z M198.185229,267.501832 L198.213843,267.70283 C198.758044,271.590429 199.047244,275.722548 199.047244,280 C199.047244,284.351307 198.747971,288.552221 198.185427,292.498324 L198.852305,292.335091 L199.509901,292.166445 C209.738539,289.482429 216.480315,284.842288 216.480315,280 C216.480315,276.231518 212.397066,272.585471 205.764704,269.888665 L205.003063,269.587466 C204.359425,269.33992 203.693615,269.1011 203.006922,268.8717 L202.172948,268.600986 L202.172948,268.600986 L201.31942,268.339582 C200.312424,268.040145 199.266515,267.76026 198.185229,267.501832 Z M161.814573,267.501676 L161.69197,267.53131 C160.310382,267.864413 158.987059,268.232603 157.729429,268.631875 L156.900823,268.902618 C156.355016,269.086124 155.822511,269.275595 155.303961,269.470678 L154.536684,269.767468 C147.726851,272.475676 143.519685,276.174763 143.519685,280 C143.519685,283.768482 147.602934,287.414529 154.235296,290.111335 L154.996937,290.412534 C155.640575,290.66008 156.306385,290.8989 156.993078,291.1283 L157.827052,291.399014 L157.827052,291.399014 L158.68058,291.660418 C159.687576,291.959855 160.733485,292.23974 161.814771,292.498168 C161.252029,288.552221 160.952756,284.351307 160.952756,280 C160.952756,275.648693 161.252029,271.447779 161.814573,267.501676 Z M180,243.519685 C176.231518,243.519685 172.585471,247.602934 169.888665,254.235296 L169.587466,254.996937 C169.33992,255.640575 169.1011,256.306385 168.8717,256.993078 L168.600986,257.827052 L168.600986,257.827052 L168.339582,258.68058 C168.040145,259.687576 167.76026,260.733485 167.501832,261.814771 C171.447779,261.252029 175.648693,260.952756 180,260.952756 C184.351307,260.952756 188.552221,261.252029 192.498324,261.814573 L192.335091,261.147695 L192.166445,260.490099 C189.482429,250.261461 184.842288,243.519685 180,243.519685 Z" id="motion-icon"></path>
        </g>
    </g>
</svg>
<h1>
    We will now ask for device motion and camera permissions.
</h1>
<div class="btn" onclick="connectToGyro()">
    OK
</div>
`;const css=`
#motion-permission-panel {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  align-items: center;
  z-index: 2;
  display: flex;
  flex-direction: column;
  width: 280px;
  padding: 30px;
  border-radius: 10px;
  background-color: #ffffff;
  box-shadow: 0 0 10px 1000px #000000;
}
#motion-permission-panel h1 {
  color: #211f1f;
  font-size: 20px !important;
  line-height: initial !important;
  font-weight: bold;
  margin: 30px 0 20px;
  text-align: center;
}
#motion-permission-panel h2 {
  color: #211f1f;
  font-size: 14px !important;
  line-height: initial !important;
  margin: 0 0 20px;
  text-align: center;
}
#motion-permission-panel .btn {
  width: 218px;
  height: 50px;
  box-shadow: none;
  border-radius: 25px;
  background: #002554;
  color: #ffffff;
  font-size: 16px;
  text-align: center;
  line-height: 50px;
}
#motion-permission-panel .btn:hover {
  cursor: pointer;
}
`;function init(){let viewport=document.querySelector("meta[name=viewport]");if(!viewport){viewport=document.createElement("meta");viewport.name="viewport";viewport.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no");document.getElementsByTagName('head')[0].appendChild(viewport);}let mustInit=true;window.addEventListener('message',async event=>{if(typeof event.data === 'string'&&event.data.startsWith('GYRO_INIT')&&mustInit){;if(DeviceMotionEvent.requestPermission){const styleSheet=document.createElement('style');styleSheet.innerText=css;document.head.appendChild(styleSheet);const panel=document.createElement('div');panel.id='motion-permission-panel';panel.innerHTML=panelContent;document.getElementById("app").appendChild(panel);mustInit=false}else{mustInit=false;await connectToGyro()}}})}async function connectToGyro(){const panel=document.getElementById('motion-permission-panel');if(panel){panel.parentNode.removeChild(panel)}if(typeof DeviceMotionEvent!=='undefined'){if(DeviceMotionEvent.requestPermission){const result=await DeviceMotionEvent.requestPermission();if(result!=='granted'){return false}}let screenOrientation=window.orientation||0;window.addEventListener('deviceorientation',event=>{window.frames[0].postMessage(`GYRO;${event.alpha};${event.beta};${event.gamma};${screenOrientation}`,'*')});window.addEventListener('orientationchange',()=>{screenOrientation=window.orientation||0},false);return true}}init();